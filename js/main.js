const form=document.querySelector("main .age-calc"),inputs=document.querySelectorAll("main .age-calc .inputs .input input"),outputs=document.querySelectorAll("main .age-calc .results div span:first-child"),invalidMessageElements=document.querySelectorAll("main .age-calc .inputs .input .invalid-message"),dateEle=document.querySelector("#date");let validatedInputs=0,isCalcDone=!0,focusedInputIndex=0;const redColor="#ff5757",date=new Date,currentYear=date.getFullYear(),currentMonth=date.getMonth()+1,currentDay=date.getDate();function handleInput(e){var t=e.dataset.max,n=/[^0-9]/gi.test(e.value),t=e.value.length>t;(n||t)&&(e.value=e.value.slice(0,-1))}function handleSubmit(e){var t=inputs[0].parentElement.parentElement.querySelector("#year"),n=t.parentElement.querySelector(".invalid-message"),r=t.parentElement.querySelector("label");e.preventDefault(),validatedInputs=0,inputs.forEach(e=>{var t=parseInt(e.dataset.limitDate),n=e.value,r=e.parentElement.querySelector(".invalid-message"),a=e.parentElement.querySelector("label");t<n||0===parseInt(n)?(a.style.color=redColor,e.style.borderColor=redColor,r.textContent="Must be a valid "+a.textContent):0===n.length?(a.style.color=redColor,e.style.borderColor=redColor,r.textContent="This field is required"):(a.style.color="",e.style.borderColor="",r.textContent="",validatedInputs++)}),t.value>currentYear&&(r.style.color=redColor,t.style.borderColor=redColor,n.textContent="Must be in the past",validatedInputs--),t.value<1900&&(r.style.color=redColor,t.style.borderColor=redColor,n.textContent=`year 1900-${currentYear} is valid`,validatedInputs--),checkValidationDaysOfMonths(parseInt(inputs[0].value),parseInt(inputs[1].value)),validatedInputs===inputs.length?calcAge():outputs.forEach(e=>e.textContent="--")}function calcAge(){var e=parseInt(inputs[0].value);let t=parseInt(inputs[1].value),n=parseInt(inputs[2].value),r,a,l,o=0,u=0,s=0;if(currentDay<e?(r=currentDay-e+31,t+=1):r=currentDay-e,currentMonth<t?(a=currentMonth-t+12,n+=1):a=currentMonth-t,l=currentYear<n?currentYear-n+1:currentYear-n,n>currentYear&&t>currentMonth)invalidAll();else if(isCalcDone){isCalcDone=!1;let e=setInterval(()=>{o!==r&&o++,u!==a&&u++,s!==l&&s++,outputs[2].textContent=o,outputs[1].textContent=u,outputs[0].textContent=s,o===r&&u===a&&s===l&&(clearInterval(e),isCalcDone=!0)},20)}}function invalidAll(){outputs.forEach(e=>e.textContent="--"),inputs.forEach(e=>{var t=e.parentElement.querySelector("label");e.style.borderColor=redColor,t.style.color=redColor,validatedInputs--})}function checkValidationDaysOfMonths(e,t){((4===t||6===t||9===t||11===t)&&30<e||2===t&&28<e)&&(inputs[0].parentElement.querySelector(".invalid-message").textContent="Must be a valid date",invalidAll())}function showtime(){let e=new Date,t=e.getHours(),n=e.getMinutes(),r=e.getSeconds();t<10?t="0"+t:n<10?n="0"+n:r<10&&(r="0"+r),document.getElementById("time").textContent=t+":"+n+":"+r}dateEle.textContent=`${currentMonth}/${currentDay}/`+currentYear,form.addEventListener("submit",e=>handleSubmit(e)),inputs.forEach((e,t)=>{e.addEventListener("input",()=>handleInput(e)),e.addEventListener("click",()=>focusedInputIndex=t)}),window.onload=setInterval(showtime,500),document.addEventListener("keydown",function(e){var t=document.activeElement;"ArrowUp"===e.key&&("year"===t.id&&0===t.value.length&&(t.value="1900"),t.value++),"ArrowDown"===e.key&&0<t.value&&t.value--,"ArrowLeft"===e.key&&0!==focusedInputIndex&&(focusedInputIndex--,inputs[focusedInputIndex].focus()),"ArrowRight"===e.key&&focusedInputIndex!==inputs.length-1&&(focusedInputIndex++,inputs[focusedInputIndex].focus())});